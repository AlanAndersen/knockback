/*
  knockback-validation.js 0.16.7
  (c) 2011, 2012 Kevin Malakoff - http://kmalakoff.github.com/knockback/
  License: MIT (http://www.opensource.org/licenses/mit-license.php)
  Dependencies: Knockout.js, Backbone.js, and Underscore.js.
*/(function(){return function(e){return typeof define=="function"&&define.amd?define("knockback-validation",["underscore","backbone","knockout","knockback"],e):e.call(this)}(function(){var e,t,n,r,i,s,o,u;return s=!this.kb&&typeof require!="undefined"?require("knockback"):this.kb,u=s._,e=s.Backbone,o=s.ko,this.Knockback=this.kb=s,typeof exports!="undefined"&&(module.exports=s),i=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,t=/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/,r=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,n=["value","valueUpdate","inject"],s.validators={required:function(e){return!!e},url:function(e){return!!i.test(e)},email:function(e){return!!t.test(e)},number:function(e){return!!r.test(e)}},s.valueValidator=function(e,t){return o.dependentObservable(function(){var n,r,i,s;i={valid:!0},n=o.utils.unwrapObservable(e);for(r in t)s=t[r],i[r]=!o.utils.unwrapObservable(s)(n),i.valid&=!i[r];return i.valid=!!i.valid,i.invalid=!i.valid,i})},s.inputValidator=function(e,t,r){var i,o,a,f,l,c,h,p,d;i=$(t),(f=i.attr("name"))&&!u.isString(f)&&(f=null),h=r&&r.skip_attach;if(!(o=i.attr("data-bind")))return null;l=(new Function("sc","with(sc[0]) { return { "+o+" } }"))([e]);if(!l||!l.value)return null;o={},s.validators[p=i.attr("type")]&&(o[p]=s.validators[p]),i.attr("required")&&(o.required=s.validators.required);for(a in l)d=l[a],!u.contains(n,a)&&typeof d=="function"&&(o[a]=d);return c=s.valueValidator(l.value,o),f&&!h&&(e["$"+f]=c),c},s.formValidator=function(e,t){var n,r,i,a,f,l,c,h,p,d;f={},c=[],n=$(t),(r=n.attr("name"))&&!u.isString(r)&&(r=null),d=n.find("input");for(h=0,p=d.length;h<p;h++){i=d[h];if(!(a=$(i).attr("name")))continue;l=s.inputValidator(e,i,r?{skip_attach:!0}:null),!l||c.push(f[a]=l)}return f.valid=o.dependentObservable(function(){var e,t,n;e=!0;for(t=0,n=c.length;t<n;t++)l=c[t],e&=l().valid;return e}),f.invalid=o.dependentObservable(function(){return!f.valid()}),r&&(e["$"+r]=f),f},s})}).call(this);