/*
  knockback-validation.js 0.16.6
  (c) 2011, 2012 Kevin Malakoff - http://kmalakoff.github.com/knockback/
  License: MIT (http://www.opensource.org/licenses/mit-license.php)
  Dependencies: Knockout.js, Backbone.js, and Underscore.js.
*/(function(){return function(e){return typeof define=="function"&&define.amd?define("knockback-validation",["underscore","backbone","knockout","knockback"],e):e.call(this)}(function(){var e,t,n,r,i,s,o,u;return s=!this.kb&&typeof require!="undefined"?require("knockback"):this.kb,u=s._,e=s.Backbone,o=s.ko,this.Knockback=this.kb=s,typeof exports!="undefined"&&(module.exports=s),i=function(e,t){var n,r;n="return ( "+e+" )",r=-1;while(++r<t)n="with(sc["+r+"]) { "+n+" }";return new Function("sc",n)},r=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,t=/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/,n=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,s.validators={required:function(e){return!e},url:function(e){return!r.test(e)},email:function(e){return!t.test(e)},number:function(e){return!n.test(e)}},s.valueValidator=function(e,t){return u.isArray(t)||(t=[t]),o.dependentObservable(function(){var n,r,i,u,a,f;i={invalid:!1},r=o.utils.unwrapObservable(e);for(a=0,f=t.length;a<f;a++){n=t[a],u=s.validators[n];if(!u)continue;i[n]=u(r),i.invalid|=i[n]}return i.valid=!i.invalid,i})},s.inputValidator=function(e,t,n){var r,o,a,f,l,c,h;r=$(t),(f=r.attr("name"))&&!u.isString(f)&&(f=null),h=n&&n.skip_attach;if(!(o=r.attr("data-bind")))return null;l=i("{"+o+"}",1)([e]);if(!l||!l.value)return null;a=[];switch(r.attr("type")){case"url":a.push("url");break;case"email":a.push("email");break;case"number":a.push("number")}return r.attr("required")&&a.push("required"),c=s.valueValidator(l.value,a),f&&!h&&(e["$"+f]=c),c},s.formValidator=function(e,t){var n,r,i,a,f,l,c,h,p,d;f={},c=[],n=$(t),(r=n.attr("name"))&&!u.isString(r)&&(r=null),d=n.find("input");for(h=0,p=d.length;h<p;h++){i=d[h];if(!(a=$(i).attr("name")))continue;l=s.inputValidator(e,i,r?{skip_attach:!0}:null),!l||c.push(f[a]=l)}return f.valid=o.dependentObservable(function(){var e,t,n;e=!0;for(t=0,n=c.length;t<n;t++)l=c[t],e&=l().valid;return e}),f.invalid=o.dependentObservable(function(){return!f.valid()}),r&&(e["$"+r]=f),f},s})}).call(this);